---
import { make as TestimonialCarouselReact } from "./TestimonialCarouselReact.res.mjs";
import SectionTitle from "./SectionTitle.astro";
import SplotchyBackground from "./SplotchyBackground.astro";

export interface Props {
  count: number;
}

let { count } = Astro.props;

// Extract slot content
const slots = [];
for (let i = 1; i <= count; i++) {
  const slotName = `testimonial-${i}`;
  const hasSlot = Astro.slots.has(slotName);
  if (hasSlot) {
    slots.push(await Astro.slots.render(slotName));
  }
}
---

<style>
  .active-dot {
    transform: scale(130%);
    background-color: var(--color-app-active-grey) !important;
  }
  .move-left {
    position: absolute;
    opacity: 0;
    transform: translateX(-50rem);
  }
  .move-right {
    position: absolute;
    opacity: 0;
    transform: translateX(50rem);
  }
</style>
<SplotchyBackground
  classes="carousel w-dvw flex flex-col justify-center items-center py-8 testimonials"
>
  <SectionTitle title="What our clients say about us" />
  <TestimonialCarouselReact client:load count={count}>
    {slots.map((slot, i) => <div key={i} set:html={slot} />)}
  </TestimonialCarouselReact>
</SplotchyBackground>
